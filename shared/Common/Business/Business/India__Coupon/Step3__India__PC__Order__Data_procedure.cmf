<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:44831da2-fa57-48b1-b3e8-4297d727cb06 -->
<metadata name="Step3_India_PC_Order_Data" path="/shared/Common/Business/Business/India_Coupon/Step3_India_PC_Order_Data" type="PROCEDURE" subtype="SQL_SCRIPT_PROCEDURE" changeToken="0">
  <parameters>
    <parameter name="waveYearMonth" direction="IN" nullable="true">
      <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
    </parameter>
    <parameter name="result" direction="OUT" nullable="true">
      <datatype name="result" type="TABLE" refId="1">
        <element name="wave_year_month">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="volume_imc">
          <datatype name="BIGINT" type="INTEGER"/>
        </element>
        <element name="vol_imc_key_no">
          <datatype name="BIGINT" type="INTEGER"/>
        </element>
        <element name="two_timer">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="verified_flag">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="mobile">
          <datatype name="VARCHAR" type="STRING" maxLength="10"/>
        </element>
        <element name="dmd">
          <datatype name="BIGINT" type="INTEGER"/>
        </element>
        <element name="dd">
          <datatype name="BIGINT" type="INTEGER"/>
        </element>
        <element name="upline">
          <datatype name="BIGINT" type="INTEGER"/>
        </element>
        <element name="ord_month_cnt">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="months_with_order">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="orders_per_order_month">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="median_spend">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="months_since_order">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="single_payment_flag_ever">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="group_payment_flag_ever">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="distinct_brand_codes">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="net_sales">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="tenure">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="u35_flag">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="direct_pc_flag">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="fpo_flag">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="order_no_count">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="email_present">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="discount_order_count">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="sum_discount_amount">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_orders_discount">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="purchased_brand_nutrilite">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_apsa80">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_artistry">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_attitude">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_bodysponge">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_carwash">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_dailycarebundle">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_deoderant">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_dishdrop">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_drive">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_dynamite">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_gh">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_glister">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_loc">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_natureshower">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_oliveoil">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_perfumes">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_persona">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_promo">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_pursue">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_queen">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_sa8">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_satinique">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_siliconglaze">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_xs">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="purchased_brand_zoomconc">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="qty_per_order">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="discount_prop_sales">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="sum_order_item_promo_qty">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="usage_days_max_last">
          <datatype name="VARCHAR" type="STRING" maxLength="5"/>
        </element>
        <element name="amount_lc_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="fpo_flag_last">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="group_payment_flag_last">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="combined_order_flag_last">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="discount_last">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="freeitem_last">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="promo_range_last">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="promo_sku_last">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="prop_artistry_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_b_other_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_catalog_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_air_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_cook_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_hc_other_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_nutrilite_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_oppbrand_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_other_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_pc_other_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="prop_xs_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="upline_bonus_pct_last">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="grade_num">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="tier_num">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="mpv_num">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="means_num">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="consumption_num">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="awareness_num">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="mkt_support_num">
          <datatype name="DOUBLE" type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
        </element>
        <element name="dmd_cust_s3">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="dmd_cust_sales3">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="dmd_cust_val3">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="upline_cust_s3">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="upline_cust_sales3">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
        <element name="upline_cust_val3">
          <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
        </element>
      </datatype>
    </parameter>
  </parameters>
  <security>
    <owner user="nobody" domain="composite"/>
    <privilege group="all" domain="composite" privileges="READ"/>
  </security>
  <dependency target="/lib/debug/Print" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="1">
      <element name="textToPrint" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="Text" type="STRING" maxLength="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="base_sku">
        <datatype type="STRING" maxLength="7" trailingSpaces="false"/>
      </element>
      <element name="brand_code">
        <datatype type="STRING" maxLength="3"/>
      </element>
      <element name="brand_desc">
        <datatype type="STRING" maxLength="100"/>
      </element>
      <element name="item_qty">
        <datatype type="INTEGER"/>
      </element>
      <element name="order_item_promo_qty">
        <datatype type="INTEGER"/>
      </element>
      <element name="order_item_qty">
        <datatype type="INTEGER"/>
      </element>
      <element name="order_item_bv">
        <datatype type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
      </element>
      <element name="order_item_pv">
        <datatype type="DECIMAL" maxDigits="25" maxFractionalDigits="4"/>
      </element>
      <element name="amount_lc">
        <datatype type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
      </element>
      <element name="cancelled">
        <datatype type="INTEGER"/>
      </element>
      <element name="nature">
        <datatype type="STRING" maxLength="2"/>
      </element>
      <element name="whse">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="item_desc">
        <datatype type="STRING" maxLength="300"/>
      </element>
      <element name="u35_flag">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="order_qty">
        <datatype type="INTEGER"/>
      </element>
      <element name="order_imc">
        <datatype type="INTEGER"/>
      </element>
      <element name="imc_name">
        <datatype type="STRING" maxLength="360"/>
      </element>
      <element name="class">
        <datatype type="STRING" maxLength="1"/>
      </element>
      <element name="upline">
        <datatype type="INTEGER"/>
      </element>
      <element name="nature2">
        <datatype type="STRING" maxLength="150"/>
      </element>
      <element name="original_nature">
        <datatype type="STRING" maxLength="150"/>
      </element>
      <element name="imc_city">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="post_code">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="state">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="mob">
        <datatype type="STRING" maxLength="20"/>
      </element>
      <element name="email">
        <datatype type="STRING" maxLength="200"/>
      </element>
      <element name="upline_city1">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="upline_state1">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="order_no">
        <datatype type="INTEGER"/>
      </element>
      <element name="combined_order_number">
        <datatype type="INTEGER"/>
      </element>
      <element name="dmd">
        <datatype type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
      </element>
      <element name="dd">
        <datatype type="FLOAT" minValue="2.2250738585072014E-308" maxValue="1.7976931348623157E308"/>
      </element>
      <element name="dd_city1">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="dd_state1">
        <datatype type="STRING" maxLength="60"/>
      </element>
      <element name="appl_dt">
        <datatype type="DATETIME"/>
      </element>
      <element name="order_month">
        <datatype type="INTEGER"/>
      </element>
      <element name="order_dt">
        <datatype type="DATETIME"/>
      </element>
      <element name="fy">
        <datatype type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
      </element>
      <element name="volume_imc">
        <datatype type="INTEGER"/>
      </element>
      <element name="vol_imc_key_no">
        <datatype type="INTEGER"/>
      </element>
      <element name="ordering_whse">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="combined_order_flag">
        <datatype type="STRING" minLength="1" maxLength="1" trailingSpaces="false"/>
      </element>
      <element name="fpo_flag">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="direct_pc_flag">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="verified_flag">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
      <element name="dd_bonus_pct">
        <datatype type="INTEGER"/>
      </element>
      <element name="upline_bonus_pct">
        <datatype type="INTEGER"/>
      </element>
      <element name="dd_sp_month">
        <datatype type="STRING" minLength="2" maxLength="2" trailingSpaces="false"/>
      </element>
      <element name="promo_type">
        <datatype type="STRING" minLength="14" maxLength="14"/>
      </element>
      <element name="brand">
        <datatype type="STRING" maxLength="19"/>
      </element>
      <element name="product_brand">
        <datatype type="STRING" maxLength="17"/>
      </element>
      <element name="variant">
        <datatype type="STRING" maxLength="16"/>
      </element>
      <element name="strategic_focus_area">
        <datatype type="STRING" maxLength="15"/>
      </element>
      <element name="prod_size">
        <datatype type="STRING" minLength="8" maxLength="8"/>
      </element>
      <element name="units">
        <datatype type="STRING" minLength="4" maxLength="4"/>
      </element>
      <element name="usage_days">
        <datatype type="STRING" minLength="5" maxLength="5"/>
      </element>
      <element name="grade">
        <datatype type="STRING" maxLength="7"/>
      </element>
      <element name="ofc_type">
        <datatype type="STRING" minLength="4" maxLength="4"/>
      </element>
      <element name="group_payment_flag">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/Common/Physical/Formatting/India_Coupon/Pincode_Master" type="TABLE">
    <datatype type="TABLE" refId="1">
      <element name="pincode">
        <datatype type="STRING" maxLength="6"/>
      </element>
      <element name="region">
        <datatype type="STRING" minLength="7" maxLength="7"/>
      </element>
      <element name="state code">
        <datatype type="STRING" minLength="7" maxLength="7"/>
      </element>
      <element name="cluster">
        <datatype type="STRING" maxLength="24"/>
      </element>
      <element name="district">
        <datatype type="STRING" maxLength="24"/>
      </element>
      <element name="type">
        <datatype type="STRING" maxLength="7"/>
      </element>
      <element name="town">
        <datatype type="STRING" maxLength="27"/>
      </element>
      <element name="coms territory">
        <datatype type="STRING" maxLength="17"/>
      </element>
      <element name="district group">
        <datatype type="STRING" maxLength="24"/>
      </element>
      <element name="state desc">
        <datatype type="STRING" maxLength="23"/>
      </element>
      <element name="grade">
        <datatype type="STRING" maxLength="7"/>
      </element>
      <element name="mpv">
        <datatype type="STRING" maxLength="18"/>
      </element>
      <element name="means">
        <datatype type="STRING" maxLength="19"/>
      </element>
      <element name="consumption">
        <datatype type="STRING" maxLength="18"/>
      </element>
      <element name="awareness">
        <datatype type="STRING" maxLength="18"/>
      </element>
      <element name="mkt. support">
        <datatype type="STRING" maxLength="19"/>
      </element>
      <element name="tier">
        <datatype type="STRING" maxLength="7"/>
      </element>
    </datatype>
  </dependency>
  <attribute name="Script" type="STRING">PROCEDURE Step3_India_PC_Order_Data(
	IN waveYearMonth INT,
	OUT result CURSOR (
		wave_year_month INT,
		volume_imc BIGINT,
		vol_imc_key_no BIGINT,
		two_timer INT,  
		verified_flag INT,
		mobile VARCHAR(10),
		dmd BIGINT,
		dd BIGINT,
		upline BIGINT,
		ord_month_cnt INT,  
		months_with_order INT,
		orders_per_order_month INT,
		median_spend DOUBLE,
		months_since_order INT,
		single_payment_flag_ever INT,
		group_payment_flag_ever INT,	
		distinct_brand_codes INT,	   
		net_sales DOUBLE,
		tenure INT,	
		u35_flag INT,
		direct_pc_flag INT,
		fpo_flag INT,
		order_no_count INT,
		email_present INT,
		discount_order_count INT,
		sum_discount_amount DOUBLE,
		prop_orders_discount DOUBLE,
		purchased_brand_nutrilite INT,
		purchased_brand_apsa80 INT,
		purchased_brand_artistry INT,
		purchased_brand_attitude INT,
		purchased_brand_bodysponge INT,
		purchased_brand_carwash INT,
		purchased_brand_dailycarebundle INT,
		purchased_brand_deoderant INT,
		purchased_brand_dishdrop INT,
		purchased_brand_drive INT,
		purchased_brand_dynamite INT,
		purchased_brand_gh INT,
		purchased_brand_glister INT,
		purchased_brand_loc INT,
		purchased_brand_natureshower INT,
		purchased_brand_oliveoil INT,
		purchased_brand_perfumes INT,
		purchased_brand_persona INT,
		purchased_brand_promo INT,
		purchased_brand_pursue INT,
		purchased_brand_queen INT,
		purchased_brand_sa8 INT,
		purchased_brand_satinique INT,
		purchased_brand_siliconglaze INT,
		purchased_brand_xs INT,
		purchased_brand_zoomconc INT ,
		qty_per_order DOUBLE,
		discount_prop_sales DOUBLE,
		sum_order_item_promo_qty INT,
		usage_days_max_last VARCHAR(5),
		amount_lc_last DOUBLE,
		fpo_flag_last INT,
		group_payment_flag_last INT,
		combined_order_flag_last INT,
		discount_last INT,
		freeitem_last INT,
		promo_range_last INT,
		promo_sku_last INT,
		prop_artistry_last DOUBLE,
		prop_b_other_last DOUBLE,
		prop_catalog_last DOUBLE,
		prop_air_last DOUBLE,
		prop_cook_last DOUBLE,
		prop_hc_other_last DOUBLE,
		prop_nutrilite_last DOUBLE,
		prop_oppbrand_last DOUBLE,
		prop_other_last DOUBLE,
		prop_pc_other_last DOUBLE,
		prop_xs_last DOUBLE,
		upline_bonus_pct_last DOUBLE,
		grade_num INT,
		tier_num INT,
		mpv_num DOUBLE,
		means_num DOUBLE,
		consumption_num DOUBLE,
		awareness_num DOUBLE,
		mkt_support_num DOUBLE,
		dmd_cust_s3 INTEGER,
		dmd_cust_sales3 INTEGER,
		dmd_cust_val3 INTEGER,
		upline_cust_s3 INTEGER,
		upline_cust_sales3 INTEGER,			
		upline_cust_val3 INTEGER			
	)
)
BEGIN		 
  
	DECLARE waveDate DATE;
	DECLARE churnEndDate TIMESTAMP;
	DECLARE startYearMonth INT;
	DECLARE endYearMonth INT;
	DECLARE uplineStartMonth INT;

	SET waveDate = TO_DATE(TO_CHAR(waveYearMonth), &apos;YYYYMM&apos;);
	SET churnEndDate = ADD_MONTHS(waveDate,-1);						 
	SET startYearMonth = TO_CHAR(ADD_MONTHS(waveDate,-15),&apos;YYYYMM&apos;);
	SET endYearMonth = TO_CHAR(ADD_MONTHS(waveDate,-1),&apos;YYYYMM&apos;);
	SET uplineStartMonth = TO_CHAR(ADD_MONTHS(waveDate,-3),&apos;YYYYMM&apos;);

	CALL PRINT(&apos;startYearMonth=&apos; || TRIM(TO_CHAR(startYearMonth)));
	CALL PRINT(&apos;endYearMonth=&apos; || TRIM(TO_CHAR(endYearMonth)));
	CALL PRINT(&apos;uplineStartMonth=&apos; || TRIM(TO_CHAR(uplineStartMonth)));

	OPEN result FOR 
		SELECT DISTINCT  
			waveYearMonth as wave_year_month,
			Orders.volume_imc,
			Orders.vol_imc_key_no,
			CASE
				WHEN Order_Agg.churn_flag = &apos;Y&apos; and Order_Agg.ord_month_cnt = 1
				THEN 0
				WHEN Order_Agg.churn_flag = &apos;N&apos; or Order_Agg.ord_month_cnt &gt; 1
				THEN 1
				ELSE 0
			END two_timer,
			Order_Agg.verified_flag,
			Order_Agg.mobile mobile,
			Order_Agg.dmd,
			Order_Agg.dd,
			Order_Agg.upline,
			Order_Agg.ord_month_cnt,
			Order_Agg.ord_month_cnt months_with_order,
			Order_Agg.orders_per_order_month,
			Median_Spend.median_spend,
			Order_Agg.months_since_order,
			Order_Agg.single_payment_flag_ever, 
			Order_Agg.group_payment_flag_ever,
			Order_Agg.distinct_brand_codes,	   
			Order_Agg.net_sales, 
			Order_Agg.tenure,
			Order_Agg.u35_flag,
			Order_Agg.direct_pc_flag,
			Order_Agg.fpo_flag, 
			Order_Agg.order_no_count,
			Order_Agg.email_present,
			Order_Agg.discount_order_count,
			Order_Agg.sum_discount_amount, 
			Order_Agg.prop_orders_discount,	 	
			Order_Agg.purchased_brand_nutrilite,
			Order_Agg.purchased_brand_apsa80,
			Order_Agg.purchased_brand_artistry,
			Order_Agg.purchased_brand_attitude,
			Order_Agg.purchased_brand_bodysponge,
			Order_Agg.purchased_brand_carwash,
			Order_Agg.purchased_brand_dailycarebundle,
			Order_Agg.purchased_brand_deoderant,
			Order_Agg.purchased_brand_dishdrop,
			Order_Agg.purchased_brand_drive,
			Order_Agg.purchased_brand_dynamite,
			Order_Agg.purchased_brand_gh,
			Order_Agg.purchased_brand_glister,
			Order_Agg.purchased_brand_loc,
			Order_Agg.purchased_brand_natureshower,
			Order_Agg.purchased_brand_oliveoil,
			Order_Agg.purchased_brand_perfumes,
			Order_Agg.purchased_brand_persona,
			Order_Agg.purchased_brand_promo,
			Order_Agg.purchased_brand_pursue,
			Order_Agg.purchased_brand_queen,
			Order_Agg.purchased_brand_sa8 ,
			Order_Agg.purchased_brand_satinique,
			Order_Agg.purchased_brand_siliconglaze,
			Order_Agg.purchased_brand_xs,
			Order_Agg.purchased_brand_zoomconc,
			Order_Agg.qty_per_order, 
			Order_Agg.discount_prop_sales,
			Order_Agg.sum_order_item_promo_qty,
			NVL(Last_Order.usage_days_max_last,&apos;0&apos;) usage_days_max_last,
			NVL(Last_Order.amount_lc_last,0) amount_lc_last,
			NVL(Last_Order.fpo_flag_last,0) fpo_flag_last,
			NVL(Last_Order.group_payment_flag_last,0) group_payment_flag_last,
			NVL(Last_Order.combined_order_flag_last,0) combined_order_flag_last,
			NVL(Last_Order.discount_last,0) discount_last,
			NVL(Last_Order.freeitem_last,0) freeitem_last,
			NVL(Last_Order.promo_range_last,0) promo_range_last,
			NVL(Last_Order.promo_sku_last,0) promo_sku_last,
			NVL(Last_Order.prop_artistry_last,0) prop_artistry_last,
			NVL(Last_Order.prop_b_other_last,0) prop_b_other_last,
			NVL(Last_Order.prop_catalog_last,0) prop_catalog_last,
			NVL(Last_Order.prop_air_last,0) prop_air_last,
			NVL(Last_Order.prop_cook_last,0) prop_cook_last,
			NVL(Last_Order.prop_hc_other_last,0) prop_hc_other_last,
			NVL(Last_Order.prop_nutrilite_last,0) prop_nutrilite_last,
			NVL(Last_Order.prop_oppbrand_last,0) prop_oppbrand_last,
			NVL(Last_Order.prop_other_last,0) prop_other_last,
			NVL(Last_Order.prop_pc_other_last,0) prop_pc_other_last,
			NVL(Last_Order.prop_xs_last,0) prop_xs_last,
			NVL(Last_Order.upline_bonus_pct_last,0) upline_bonus_pct_last,   
			CAST(CASE WHEN Pincode_Master.tier = &apos;UNKNOWN&apos; OR Pincode_Master.tier IS NULL THEN &apos;0&apos; ELSE Pincode_Master.tier END AS INT) tier_num,
			CAST(CASE
				WHEN Pincode_Master.grade = &apos;A&apos; THEN 0
				WHEN Pincode_Master.grade = &apos;AA&apos; THEN 1
				WHEN Pincode_Master.grade = &apos;AAA&apos; THEN 2
				WHEN Pincode_Master.grade = &apos;B&apos; THEN 3
				WHEN Pincode_Master.grade = &apos;C&apos; THEN 4
				WHEN Pincode_Master.grade = &apos;D&apos; THEN 5
				WHEN Pincode_Master.grade = &apos;UNKNOWN&apos; THEN 6
				ELSE 7			
			END AS INT) grade_num,
			CAST(CASE WHEN Pincode_Master.mpv = &apos;UNKNOWN&apos; OR Pincode_Master.mpv IS NULL THEN &apos;0&apos; ELSE Pincode_Master.mpv END AS DOUBLE) as mpv_num ,
			CAST(CASE WHEN Pincode_Master.means = &apos;UNKNOWN&apos; OR Pincode_Master.means IS NULL THEN &apos;0&apos; ELSE Pincode_Master.means END AS DOUBLE) as means_num ,
			CAST(CASE WHEN Pincode_Master.consumption = &apos;UNKNOWN&apos; OR Pincode_Master.consumption IS NULL THEN &apos;0&apos; ELSE Pincode_Master.consumption END AS DOUBLE) as consumption_num ,
			CAST(CASE WHEN Pincode_Master.awareness = &apos;UNKNOWN&apos; OR Pincode_Master.awareness IS NULL THEN &apos;0&apos; ELSE Pincode_Master.awareness END AS DOUBLE) as awareness_num ,
			CAST(CASE WHEN Pincode_Master.&quot;mkt. support&quot; = &apos;UNKNOWN&apos; OR Pincode_Master.&quot;mkt. support&quot; IS NULL THEN &apos;0&apos; ELSE Pincode_Master.&quot;mkt. support&quot; END AS DOUBLE) as mkt_support_num,
			NVL(Diamond.dmd_cust_s3, 0) dmd_cust_s3,
			NVL(Diamond.dmd_cust_sales3, 0) dmd_cust_sales3,
			NVL(Diamond.dmd_cust_val3, 0) dmd_cust_val3,
			NVL(Sponsor.upline_cust_s3, 0) upline_cust_s3,
			NVL(Sponsor.upline_cust_sales3, 0) upline_cust_sales3,			
			NVL(Sponsor.upline_cust_val3, 0) upline_cust_val3						
		FROM      
			/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order Orders
		INNER JOIN
			(
				/*************************************************************/
				/*  Calculate order aggregates                               */
				/*************************************************************/
				SELECT
					volume_imc,
					MAX(dmd) dmd,
					MAX(dd) dd,
					MAX(upline) upline,
					MAX(mob) mobile,
					MAX(order_dt) max_order_date,
					MAX(order_month) max_order_month,
					DATEDIFF(&apos;MONTH&apos;, MAX(order_dt), churnEndDate) months_since_order,
					DATEDIFF(&apos;MONTH&apos;, MAX(appl_dt), churnEndDate) tenure,
					CASE
						WHEN DATEDIFF(&apos;MONTH&apos;, MAX(order_dt), churnEndDate) &gt; 6
						THEN &apos;Y&apos;
						ELSE &apos;N&apos;
					END churn_flag,
					COUNT(DISTINCT order_month) ord_month_cnt,
					NVL(COUNT(DISTINCT order_no)/ NULLIF((COUNT(DISTINCT order_month) * 1.0) ,0) ,0) orders_per_order_month, 
					COUNT(DISTINCT brand_code) distinct_brand_codes,
					MAX(CASE WHEN group_payment_flag = &apos;N&apos; THEN 1 ELSE 0 END) single_payment_flag_ever,
					MAX(CASE WHEN group_payment_flag = &apos;Y&apos; THEN 1 ELSE 0 END) group_payment_flag_ever,
					SUM(amount_lc) net_sales,
					MAX(CASE WHEN u35_flag = &apos;Y&apos; THEN 1 ELSE 0 END) u35_flag,
					MAX(CASE WHEN direct_pc_flag = &apos;N&apos; THEN 0 ELSE 1 END) direct_pc_flag,
					MAX(CASE WHEN fpo_flag=&apos;Y&apos; THEN 1 ELSE 0 END) fpo_flag,
					SUM(order_item_promo_qty) sum_order_item_promo_qty,
					COUNT(DISTINCT order_no) order_no_count,
					MAX(CASE WHEN email = &apos;&apos; OR email = &apos; &apos; THEN 0 ELSE 1 END) email_present,
					SUM(CASE WHEN promo_type = &apos;Discounts&apos; THEN amount_lc ELSE 0 END) sum_discount_amount,
					COUNT(DISTINCT CASE WHEN promo_type = &apos;Discounts&apos; THEN order_no END) discount_order_count,
					COUNT(DISTINCT CASE WHEN promo_type = &apos;Discounts&apos; THEN order_no END) / (COUNT(DISTINCT order_no) * 1.00) prop_orders_discount,
					MAX(CASE WHEN product_brand = &apos;Nutrilite&apos; THEN 1 ELSE 0 END) purchased_brand_nutrilite,
					MAX(CASE WHEN product_brand = &apos;APSA 80&apos; THEN 1 ELSE 0 END) purchased_brand_apsa80,
					MAX(CASE WHEN product_brand = &apos;Artistry&apos; THEN 1 ELSE 0 END) purchased_brand_artistry,
					MAX(CASE WHEN product_brand = &apos;Attitude&apos; THEN 1 ELSE 0 END) purchased_brand_attitude,
					MAX(CASE WHEN product_brand = &apos;Body Sponge&apos; THEN 1 ELSE 0 END) purchased_brand_bodysponge,
					MAX(CASE WHEN product_brand = &apos;Car Wash&apos; THEN 1 ELSE 0 END) purchased_brand_carwash,
					MAX(CASE WHEN product_brand = &apos;Daily Care Bundle&apos; THEN 1 ELSE 0 END) purchased_brand_dailycarebundle,
					MAX(CASE WHEN product_brand = &apos;Deoderant&apos; THEN 1 ELSE 0 END) purchased_brand_deoderant,
					MAX(CASE WHEN product_brand = &apos;Dish Drop&apos; THEN 1 ELSE 0 END) purchased_brand_dishdrop,
					MAX(CASE WHEN product_brand = &apos;Drive&apos; THEN 1 ELSE 0 END) purchased_brand_drive,
					MAX(CASE WHEN product_brand = &apos;Dynamite&apos; THEN 1 ELSE 0 END) purchased_brand_dynamite,
					MAX(CASE WHEN product_brand = &apos;G&amp;H&apos; THEN 1 ELSE 0 END) purchased_brand_gh,
					MAX(CASE WHEN product_brand = &apos;Glister&apos; THEN 1 ELSE 0 END) purchased_brand_glister,
					MAX(CASE WHEN product_brand = &apos;LOC&apos; THEN 1 ELSE 0 END) purchased_brand_loc,
					MAX(CASE WHEN product_brand = &apos;Nature Shower&apos; THEN 1 ELSE 0 END) purchased_brand_natureshower,
					MAX(CASE WHEN product_brand = &apos;Olive oil&apos; THEN 1 ELSE 0 END) purchased_brand_oliveoil,
					MAX(CASE WHEN product_brand = &apos;Perfumes&apos; THEN 1 ELSE 0 END) purchased_brand_perfumes,
					MAX(CASE WHEN product_brand = &apos;Persona&apos; THEN 1 ELSE 0 END) purchased_brand_persona,
					MAX(CASE WHEN product_brand = &apos;Promo&apos; THEN 1 ELSE 0 END) purchased_brand_promo,
					MAX(CASE WHEN product_brand = &apos;Pursue &apos; THEN 1 ELSE 0 END) purchased_brand_pursue,
					MAX(CASE WHEN product_brand = &apos;Queen&apos; THEN 1 ELSE 0 END) purchased_brand_queen,
					MAX(CASE WHEN product_brand = &apos;SA8&apos; THEN 1 ELSE 0 END) purchased_brand_sa8,
					MAX(CASE WHEN product_brand = &apos;Satinique&apos; THEN 1 ELSE 0 END) purchased_brand_satinique,
					MAX(CASE WHEN product_brand = &apos;Silicon Glaze&apos; THEN 1 ELSE 0 END) purchased_brand_siliconglaze,
					MAX(CASE WHEN product_brand = &apos;XS &apos; THEN 1 ELSE 0 END) purchased_brand_xs,
					MAX(CASE WHEN product_brand = &apos;Zoom Conc&apos; THEN 1 ELSE 0 END) purchased_brand_zoomconc,
					NVL(SUM(order_qty) / NULLIF((COUNT(DISTINCT order_no)*1.00), 0), 0) as qty_per_order,
					NVL(SUM(CASE WHEN promo_type = &apos;Discounts&apos; THEN amount_lc ELSE 0 END ) / NULLIF(SUM(amount_lc),0),0) AS discount_prop_sales,
					MAX(post_code) post_code,
					MAX(CASE WHEN verified_flag = &apos;Y&apos; THEN 1 ELSE 0 END) verified_flag 					
				FROM      
					/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order
				WHERE
					order_month BETWEEN startYearMonth and endYearMonth
				GROUP BY
					volume_imc
			) Order_Agg
		ON
			Orders.volume_imc = Order_Agg.volume_imc
		INNER JOIN
			(
				/*************************************************************/
				/*  Calculate median spend (per month)                       */
				/*************************************************************/
				SELECT
					volume_imc,
					MEDIAN(amount_lc) median_spend
				FROM      
					(
						SELECT
							volume_imc,
							order_month,
							SUM(amount_lc) amount_lc
						FROM      
							/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order									
						WHERE
							order_month BETWEEN startYearMonth and endYearMonth
						GROUP BY
							volume_imc,
							order_month					
					) Spend_Per_Month			
				GROUP BY
					volume_imc
			) Median_Spend
		ON
			Orders.volume_imc = Median_Spend.volume_imc
		INNER JOIN
			(
				/*************************************************************/
				/*  Last order aggregates                                    */
				/*************************************************************/			
 
				SELECT
					Last_Order.volume_imc,
					MAX(CASE WHEN Last_Order.usage_days is null or Last_Order.usage_days=&apos;#N/A&apos; or Last_Order.usage_days=&apos;None&apos; THEN &apos;0&apos; ELSE Last_Order.usage_days END ) as usage_days_max_last,
					SUM(Last_Order.amount_lc) as amount_lc_last,
					MAX(CASE WHEN Last_Order.fpo_flag=&apos;Y&apos; THEN 1 ELSE 0 END) as fpo_flag_last,
					MAX(CASE WHEN Last_Order.group_payment_flag =&apos;Y&apos; THEN 1 ELSE 0 END) as group_payment_flag_last,
					MAX(CASE WHEN Last_Order.combined_order_flag =&apos;Y&apos; THEN 1 ELSE 0 END) as combined_order_flag_last,
					MAX(CASE WHEN Last_Order.promo_type =&apos;Discounts&apos; THEN 1 ELSE 0 END) as discount_last,
					MAX(CASE WHEN Last_Order.promo_type =&apos;Free Item&apos; THEN 1 ELSE 0 END) as freeitem_last,
					MAX(CASE WHEN Last_Order.promo_type =&apos;Promo on Range&apos; THEN 1 ELSE 0 END) as promo_range_last,
					MAX(CASE WHEN Last_Order.promo_type =&apos;Promo on SKU&apos; THEN 1 ELSE 0 END) as promo_sku_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Beauty - Artistry&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_artistry_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Beauty - Other&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_b_other_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Catalog&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_catalog_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Durables - Air&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_air_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Durables - Cookware&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_cook_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Home Care - Other&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_hc_other_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Nutrition &amp; Wellness - Nutrilite&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_nutrilite_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Opportunity Brand - Amway/Quixtar&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_oppbrand_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Other&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_other_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;Personal Care - Other&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_pc_other_last,
					SUM(CASE WHEN Last_Order.brand_desc =&apos;XS Energy Portfolio&apos; THEN Last_Order.amount_lc ELSE 0 END) / NULLIF(SUM(Last_Order.amount_lc),0) as prop_xs_last,
					NVL(AVG(upline_bonus_pct),0) upline_bonus_pct_last					
				FROM      
					/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order Last_Order
				INNER JOIN
					(SELECT volume_imc, MAX(order_month) max_order_month FROM /shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order WHERE order_month BETWEEN startYearMonth and endYearMonth GROUP BY volume_imc) Order_Agg
				ON
					Last_Order.volume_imc = Order_Agg.volume_imc
					AND Last_Order.order_month = Order_Agg.max_order_month
				WHERE
					order_month BETWEEN startYearMonth and endYearMonth
				GROUP BY
					Last_Order.volume_imc				
			) Last_Order
		ON
			Orders.volume_imc = Last_Order.volume_imc
		INNER JOIN
			(
				/*************************************************************/
				/*  Calculate sponsor&apos;s customer metrics (past 3 months)     */
				/*************************************************************/
				SELECT
					upline,
					count(distinct volume_imc) as upline_cust_s3,
					round(sum(amount_lc)) as upline_cust_sales3,
					round(sum(amount_lc) / count(distinct volume_imc)) as upline_cust_val3
				FROM      
					/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order
				WHERE
					order_month BETWEEN uplineStartMonth and endYearMonth
				GROUP BY
					upline
			) Sponsor
		ON
			Orders.upline = Sponsor.upline							
		INNER JOIN
			(
				/*************************************************************/
				/*  Calculate diamonds&apos;s customer metrics (past 3 months)    */
				/*************************************************************/
				SELECT
					dmd,
					count(distinct volume_imc) as dmd_cust_s3,
					round(sum(amount_lc)) as dmd_cust_sales3,
					round(sum(amount_lc) / count(distinct volume_imc)) as dmd_cust_val3
				FROM      
					/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order
				WHERE
					order_month BETWEEN uplineStartMonth and endYearMonth
				GROUP BY
					dmd
			) Diamond
		ON
			Orders.dmd = Diamond.dmd
		LEFT JOIN
			/shared/Common/Physical/Formatting/India_Coupon/Pincode_Master Pincode_Master
		ON
			Order_Agg.post_code = Pincode_Master.pincode
		LEFT JOIN
			(	
				/*****************************************************/  
				/*   Aggregate the number of promotions used per PC  */
				/*****************************************************/
				SELECT
					Promos_Monthly.volume_imc,
					1 AS prm_used_flag,
					SUM(Promos_Monthly.prm_count_monthly) prm_count_total,
					SUM(Promos_Monthly.prm_order_count) prm_order_count
				FROM
					(
						SELECT
							volume_imc,
							order_month,
							COUNT(DISTINCT order_no) prm_order_count,
							COUNT(DISTINCT base_sku) prm_count_monthly						
						FROM      
							/shared/Common/Business/Business/India_Coupon/Step2_India_Consolidated_Order
						WHERE
							order_month BETWEEN startYearMonth and endYearMonth
							AND base_sku like &apos;PRM%&apos;
						GROUP BY
							volume_imc,
							order_month
					) Promos_Monthly
				GROUP BY
					Promos_Monthly.volume_imc
			) Promos
		ON
			Orders.volume_imc = Promos.volume_imc
		WHERE
			Orders.order_month BETWEEN startYearMonth and endYearMonth
			AND Orders.mob NOT LIKE &apos; %&apos; -- Must have a mobile phone #	
			;
END</attribute>
  <attribute name="creationDate" type="LONG">1569201791860</attribute>
  <attribute name="creatorUserDomain" type="STRING">na</attribute>
  <attribute name="creatorUserId" type="INTEGER">30105</attribute>
  <attribute name="creatorUserName" type="STRING">asp5665</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1573531753688</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">na</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">30105</attribute>
  <attribute name="lastModifiedUserName" type="STRING">asp5665</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="native_only" type="STRING">false</attribute>
  <attribute name="references" type="MAP">
    <item>
      <key type="STRING">7/111</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">7/110</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">7/112</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
  </attribute>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1569201791860</attribute>
</metadata>